cmake_minimum_required(VERSION 2.8)

project(kurento-media-server)

if(EXISTS "${CMAKE_SOURCE_DIR}/.git")
	execute_process(COMMAND git submodule init WORKING_DIRECTORY ${CMAKE_SOURCE_DIR})
	execute_process(COMMAND git submodule update WORKING_DIRECTORY ${CMAKE_SOURCE_DIR})
	execute_process(COMMAND git describe --abbrev=6 --tags --dirty --always --match "kmsc-*"
			OUTPUT_VARIABLE KMSC_VERSION
			OUTPUT_STRIP_TRAILING_WHITESPACE)
	string(REGEX REPLACE "^kmsc-(.*)" "\\1" KMSC_VERSION ${KMSC_VERSION})
	if (NOT EXISTS "${CMAKE_SOURCE_DIR}/.git/hooks/pre-commit")
		execute_process(COMMAND ln -s ../../hooks/pre-commit.hook
			${CMAKE_SOURCE_DIR}/.git/hooks/pre-commit)
	endif(NOT EXISTS "${CMAKE_SOURCE_DIR}/.git/hooks/pre-commit")
else(EXISTS "${CMAKE_SOURCE_DIR}/.git")
	set(KMSC_MAJOR_VERSION 2)
	set(KMSC_MINOR_VERSION 0)
	set(KMSC_PATCH_VERSION 0-dev)
	set(KMSC_VERSION
		${KMSC_MAJOR_VERSION}.${KMSC_MINOR_VERSION}.${KMSC_PATCH_VERSION})
endif(EXISTS "${CMAKE_SOURCE_DIR}/.git")

set (GSTREAMER_PLUGINS_DIR ${CMAKE_BINARY_DIR}/plugins)

execute_process(COMMAND bash -c "export FINAL_INSTALL_DIR=/usr;./autogen.sh --prefix=${GSTREAMER_PLUGINS_DIR}" WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}/gst-kurento-plugins)

add_custom_target(plugins COMMAND make install WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}/gst-kurento-plugins)

CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/config.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config.h)

# TODO: Check if HAVE_INIT_TYPES_H has to be added (not in all systems)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -g -Wall -Werror -std=c++0x -DGST_DISABLE_DEPRECATED")
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -g -Wall -Werror -std=c99 -DGST_DISABLE_DEPRECATED")

set(CUSTOM_PREFIX "kurento")
set(INCLUDE_PREFIX "include/${CUSTOM_PREFIX}")
set(LIB_PREFIX "lib")

find_package(PkgConfig)

pkg_check_modules(GLIB2 REQUIRED glib-2.0>=2.30)
pkg_check_modules(GSTREAMER REQUIRED gstreamer-1.0>=1.0.5)
pkg_check_modules(GSTREAMER_SDP REQUIRED gstreamer-sdp-1.0>=1.0.5)
pkg_check_modules(THRIFT REQUIRED thrift-nb>=0.9.0)
pkg_check_modules(EVENT REQUIRED libevent>=2.0.16-stable)
pkg_check_modules(GLIBMM REQUIRED glibmm-2.4>=2.30)
pkg_check_modules(UUID REQUIRED uuid>=2.20.0)

include(ExternalProject)

SET(KMSIFACE_INCLUDE_DIR ${CMAKE_BINARY_DIR}/gen-cpp)

add_subdirectory(kms-interface)

add_subdirectory(httpepserver)

add_subdirectory(server)

add_subdirectory(test)

enable_testing()

add_test(utils_test test/utils_test)
add_test(media_handler_test test/media_handler_test)

add_test(server_test test/server_test)
set_tests_properties(server_test PROPERTIES ENVIRONMENT "MEDIA_SERVER_CONF_FILE=${CMAKE_SOURCE_DIR}/kurento.conf")

# Temporally disabled
if (0)

add_test(http_ep_server_test test/http_ep_server_test)
set_tests_properties(http_ep_server_test PROPERTIES ENVIRONMENT "MEDIA_SERVER_CONF_FILE=${CMAKE_SOURCE_DIR}/kurento.conf")

if (DEFINED MEMORY_TEST)
  message("Memory test active")
  add_test(server_memory_test test/server_memory_test)
  set_tests_properties(server_memory_test PROPERTIES ENVIRONMENT "MEDIA_SERVER_CONF_FILE=${CMAKE_SOURCE_DIR}/kurento.conf")
endif()

endif ()
add_custom_target(check COMMAND ${CMAKE_CTEST_COMMAND})




set(CPACK_GENERATOR "DEB;TGZ;STGZ")
set(CPACK_PACKAGE_CONTACT "kurento@googlegroups.com")

set(CPACK_PACKAGE_NAME "kurento")
set(CPACK_PACKAGE_VENDOR "Kurento")
set(CPACK_PACKAGE_VERSION ${KMSC_VERSION})
set(CPACK_RESOURCE_FILE_LICENSE ${CMAKE_SOURCE_DIR}/license.txt)
set(CPACK_PACKAGING_INSTALL_PREFIX "/")

include(CheckTypeSize)
check_type_size("void *" SIZEOF_VOID_P BUILTIN_TYPES_ONLY)

if (${SIZEOF_VOID_P} GREATER 4)
	set(CPACK_DEBIAN_PACKAGE_ARCHITECTURE "amd64")
else(${SIZEOF_VOID_P} GREATER 4)
	set(CPACK_DEBIAN_PACKAGE_ARCHITECTURE "i686")
endif(${SIZEOF_VOID_P} GREATER 4)

SET(CPACK_DEBIAN_PACKAGE_DEPENDS "gir1.2-gstreamer-1.0 (>= 1.0.6-1), gstreamer1.0-alsa (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-clutter (>= 2.0.2-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-crystalhd (>= 1:0.0~git20110715.fdd2f19-9ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-doc (>= 1.0.6-1), gstreamer1.0-libav (>= 1.0.6-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-libav-dbg (>= 1.0.6-1), gstreamer1.0-nice (>= 0.1.3-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-bad (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-bad-dbg (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-bad-doc (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-base (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-base-apps (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-base-dbg (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-base-doc (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-good (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-good-dbg (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-good-doc (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-ugly (>= 1.0.6-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-ugly-dbg (>= 1.0.6-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-plugins-ugly-doc (>= 1.0.6-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-pulseaudio (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gstreamer1.0-tools (>= 1.0.6-1), gstreamer1.0-x (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgstreamer-plugins-bad1.0-0 (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgstreamer-plugins-base1.0-0 (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgstreamer-plugins-base1.0-dev (>= 1.0.6-1kurento2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgstreamer-plugins-good1.0-0 (>= 1.0.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgstreamer1.0-0 (>= 1.0.6-1), libgstreamer1.0-0-dbg (>= 1.0.6-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgstreamer1.0-dev (>= 1.0.6-1), liblzo2-2 (>= 2.06-1build1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libnettle4 (>= 2.4-3), libarchive13 (>= 3.1.2-5ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libcairo-script-interpreter2 (>= 1.12.14-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libevent-core-2.0-5 (>= 2.0.19-stable-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libevent-extra-2.0-5 (>= 2.0.19-stable-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libevent-openssl-2.0-5 (>= 2.0.19-stable-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libevent-pthreads-2.0-5 (>= 2.0.19-stable-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libglibmm-2.4-1c2a (>= 2.35.9-0ubuntu1), libgtk2.0-common,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgtk2.0-0 (>= 2.24.17-0ubuntu2), libice6 (>= 2:1.0.8-2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libilmbase6 (>= 1.0.1-6), libopenexr6 (>= 1.6.1-7),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libexpat1-dev (>= 2.1.0-2), libpython2.7-dev (>= 2.7.4-2ubuntu3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libsm6 (>= 2:1.2.1-2), libtiffxx5 (>= 4.0.2-4ubuntu2.1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libdc1394-22 (>= 2.2.0-2build1), libjbig-dev (>= 2.0-2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libcr0 (>= 0.8.5-2), blcr-util (>= 0.8.5-2), emacsen-common,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} cmake-data, cmake (>= 2.8.10.1-0ubuntu6),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gccxml (>= 0.9.0+cvs20120420-4ubuntu2), gir1.2-atk-1.0 (>= 2.8.0-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gir1.2-freedesktop (>= 1.36.0-1), gir1.2-gdkpixbuf-2.0 (>= 2.28.0-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gir1.2-pango-1.0 (>= 1.32.5-0ubuntu1), gir1.2-gtk-2.0 (>= 2.24.17-0ubuntu2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} gir1.2-soup-2.4 (>= 2.40.3-0ubuntu1), libatk1.0-dev (>= 2.8.0-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libavutil-dev (>= 6:0.8.6-1ubuntu2), libavcodec-dev (>= 6:0.8.6-1ubuntu2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libavformat-dev (>= 6:0.8.6-1ubuntu2), libboost-atomic1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-atomic1.53-dev (>= 1.53.0-3), libboost1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-system1.53.0 (>= 1.53.0-3), libboost-chrono1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-chrono1.53-dev (>= 1.53.0-3), libboost-context1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-context1.53-dev (>= 1.53.0-3), libboost-date-time1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-serialization1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-serialization1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-date-time1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-exception1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-filesystem1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-system1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-filesystem1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-test1.53.0 (>= 1.53.0-3), libboost-test1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-graph-parallel1.53-dev (>= 1.53.0-3), libibverbs1 (>= 1.1.6-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libtorque2 (>= 2.4.16+dfsg-1ubuntu1), libopenmpi1.3 (>= 1.4.5-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-mpi1.53.0 (>= 1.53.0-3), libboost-graph-parallel1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-graph1.53-dev (>= 1.53.0-3), libboost-regex1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-graph1.53.0 (>= 1.53.0-3), libicu-dev (>= 4.8.1.1-12),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-regex1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-iostreams1.53.0 (>= 1.53.0-3), libboost-iostreams1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-thread1.53.0 (>= 1.53.0-3), libboost-locale1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-locale1.53-dev (>= 1.53.0-3), libboost-math1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-math1.53-dev (>= 1.53.0-3), openmpi-common,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libibverbs-dev (>= 1.1.6-1ubuntu1), libopenmpi-dev (>= 1.4.5-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} mpi-default-dev (>= 1.0.1), libboost-mpi1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-python1.53.0 (>= 1.53.0-3), openmpi-bin (>= 1.4.5-1ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} mpi-default-bin (>= 1.0.1), libboost-mpi-python1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-mpi-python1.53-dev (>= 1.53.0-3), libboost-program-options1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-program-options1.53-dev (>= 1.53.0-3), libpython-dev (>= 2.7.4-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} python2.7-dev (>= 2.7.4-2ubuntu3), python-dev (>= 2.7.4-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-python1.53-dev (>= 1.53.0-3), libboost-random1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-random1.53-dev (>= 1.53.0-3), libboost-signals1.53.0 (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-signals1.53-dev (>= 1.53.0-3), libboost-thread1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-timer1.53.0 (>= 1.53.0-3), libboost-timer1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost-wave1.53.0 (>= 1.53.0-3), libboost-wave1.53-dev (>= 1.53.0-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libboost1.53-all-dev (>= 1.53.0-3), libfreetype6-dev (>= 2.4.11-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libfontconfig1-dev (>= 2.10.2-0ubuntu2), xorg-sgml-doctools, x11proto-core-dev,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxau-dev (>= 1:1.0.7-1), libxdmcp-dev (>= 1:1.1.1-1), x11proto-input-dev,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} x11proto-kb-dev, xtrans-dev, libpthread-stubs0 (>= 0.3-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libpthread-stubs0-dev (>= 0.3-3), libxcb1-dev (>= 1.8.1-2ubuntu2.1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libx11-dev (>= 2:1.5.0-1ubuntu1.1), x11proto-render-dev,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxrender-dev (>= 1:0.9.7-1ubuntu0.13.04.1), libpng12-dev (>= 1.2.49-1ubuntu2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libice-dev (>= 2:1.0.8-2), libsm-dev (>= 2:1.2.1-2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libpixman-1-dev (>= 0.28.2-0ubuntu1), libxcb-render0-dev (>= 1.8.1-2ubuntu2.1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxcb-shm0-dev (>= 1.8.1-2ubuntu2.1), x11proto-xext-dev,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxext-dev (>= 2:1.3.1-2ubuntu0.13.04.1), libcairo2-dev (>= 1.12.14-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libtbb2 (>= 4.0+r233-1), libopencv-core2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-core-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-imgproc2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-imgproc-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-flann2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-flann-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-features2d2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-features2d-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-calib3d2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-calib3d-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-highgui2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libswscale-dev (>= 6:0.8.6-1ubuntu2), libgdk-pixbuf2.0-dev (>= 2.28.0-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libharfbuzz-dev (>= 0.9.13-1), libxft-dev (>= 2.3.1-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libpango1.0-dev (>= 1.32.5-0ubuntu1), x11proto-xinerama-dev,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxinerama-dev (>= 2:1.1.2-1ubuntu0.13.04.1), libxi-dev (>= 2:1.6.99.1-0ubuntu3.1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} x11proto-randr-dev, libxrandr-dev (>= 2:1.4.0-1ubuntu1.1), x11proto-fixes-dev,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxfixes-dev (>= 1:5.0-4ubuntu5.13.04.1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxcursor-dev (>= 1:1.1.13-1ubuntu0.13.04.1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} x11proto-composite-dev, libxcomposite-dev (>= 1:0.4.3-2build2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} x11proto-damage-dev, libxdamage-dev (>= 1:1.1.3-2build2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libxml2-utils (>= 2.9.0+dfsg1-4ubuntu4.3), libgtk2.0-dev (>= 2.24.17-0ubuntu2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libjasper-dev (>= 1.900.1-14), libjpeg-turbo8-dev (>= 1.2.1-0ubuntu2),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libjpeg8-dev (>= 8c-2ubuntu7), libjpeg-dev, liblzma-dev (>= 5.1.1alpha+20120614-2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libtiff5-dev (>= 4.0.2-4ubuntu2.1), libilmbase-dev (>= 1.0.1-6),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopenexr-dev (>= 1.6.1-7), libraw1394-dev (>= 2.0.9-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libdc1394-22-dev (>= 2.2.0-2build1), libopencv-highgui-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-objdetect2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-objdetect-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-video2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-video-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-ml2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-ml-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-legacy2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-legacy-dev (>= 2.4.2+dfsg-0exp2ubuntu1), libcv-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-contrib2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-contrib-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libcvaux-dev (>= 2.4.2+dfsg-0exp2ubuntu1), libevent-dev (>= 2.0.19-stable-3),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libsigc++-2.0-dev (>= 2.2.10-0.2), libglibmm-2.4-dev (>= 2.35.9-0ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libgtk2.0-bin (>= 2.24.17-0ubuntu2), libhighgui-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-ts2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-ts-dev (>= 2.4.2+dfsg-0exp2ubuntu1), libopencv-photo2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-photo-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-videostab2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-videostab-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-stitching2.4 (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-stitching-dev (>= 2.4.2+dfsg-0exp2ubuntu1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libopencv-dev (>= 2.4.2+dfsg-0exp2ubuntu1), libraw1394-tools (>= 2.0.9-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libsoup2.4-dev (>= 2.40.3-0ubuntu1), libx11-doc,")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} openmpi-checkpoint (>= 1.4.5-1ubuntu1), uuid-dev (>= 2.20.1-5.1ubuntu8),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} libtesseract-dev (>= 3.02.02-1), libtesseract3 (>= 3.02.02-1),")
SET(CPACK_DEBIAN_PACKAGE_DEPENDS "${CPACK_DEBIAN_PACKAGE_DEPENDS} tesseract-ocr-dev (>= 3.02.02-1), tesseract-ocr-eng (>= 3.02-2)")
# Is also possible to set DEBIAN_PACKAGE_BUILDS_DEPENDS

if(NOT DEFINED SYSCONFDIR)
	set(SYSCONFDIR etc)
endif(NOT DEFINED SYSCONFDIR)

install(FILES kurento.conf pattern.sdp DESTINATION ${SYSCONFDIR}/${CUSTOM_PREFIX})
install(PROGRAMS "scripts/init.d/kurento" DESTINATION ${SYSCONFDIR}/init.d)
install(FILES "scripts/default/kurento" DESTINATION ${SYSCONFDIR}/default)
install(DIRECTORY ${GSTREAMER_PLUGINS_DIR}/lib/gstreamer-1.0 USE_SOURCE_PERMISSIONS DESTINATION usr/lib)
install(DIRECTORY ${GSTREAMER_PLUGINS_DIR}/share/gst-kurento-plugins USE_SOURCE_PERMISSIONS DESTINATION usr/share)

include(CPack)
